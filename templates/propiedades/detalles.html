{% extends 'base.html' %}
{% load static %}{% load utilidades %}
{% block title %}
  {% for propiedad in propiedades %}
    {% if propiedad.id == id %}
      <title>{{propiedad.slug}}</title>
    {%endif%}
  {%endfor%}

{% endblock title %}
{% block extra_navbar %} {% include 'componentes/navbar.html' %} {% endblock extra_navbar %}
{% block content %}

<!-- Modal Todas las Ofertas -->
<div id="modal-component-ofertas-containet" class="hidden fixed min-h-full min-w-full bg-gray-200 bg-opacity-50">
  <div class="modal-flex-container justify-center">
    <div id ="modal-ofertas-container" class="modal-container max-w-md mx-auto bg-white mt-4 p-4 rounded-xl border-gray-400">
      <div class="modal-wrapper">
        <div class="modal-wrapper-flex">
          <div class="modal-content">
            <div class="flex flex-col px-6">
              <div class="overflow-x-auto sm:-mx-6 lg:-mx-8">
                <div class="py-2 inline-block min-w-full sm:px-6 lg:px-8">
                  <div class="overflow-hidden">
                    <h2>Todas las Ofertas Recibidas para esta propiedad</h2>
                    <table class="min-w-full">
                      <tbody>
                        {% for oferta in todas_ofertas %}
                        <tr class="bg-gray-100 border-b">
                          <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                            {{oferta.fecha|date:"d-m-y"}}
                          </td>
                          <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                            {{oferta.monto|numberFormatInt}} UF
                          </td>
                          <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                            {{oferta.estado}}
                          </td>
                        </tr>
                        {%endfor%}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <button id="close-modal-ofertas" class="ml-1 px-6 py-2.5 boton-busqueda-portada rounded-lg w-full h-full text-white font-medium text-lg">volver</button>
          </div>  
        </div>
      </div>
    </div>
  </div>
</div>

<!--Carrousel de Imagenes de la Propiedad-->
<div id="controls-carousel"  class="block pt-10 px-4 sm:px-2 mx-auto max-w-4xl">
  <div class="grid sm:grid-cols-5 grid-cols-3 gap-4">
    <div class= "col-span-3 relative">
        {% for propiedad in propiedades %}
        {% if propiedad.id == id %}
        <div class="h-60 sm:h-80 sm:w-full rounded-2xl border-solid border-slate-100 min-w-sm gallery-item-detalle">
            <div class="">
                <div  class="relative" data-carousel="static">
                <!-- Carousel wrapper -->
                    <div class="flex relative h-60 sm:h-80 sm:w-full overflow-hidden rounded-2xl min-w-full ">
                        {% for image in images  %}
                        {% if image.id_propiedades.id == propiedad.id %}
                            <div class="hidden duration-700 ease-in-out" data-carousel-item>
                                <img src="{{ image.image.url }}" class="absolute block h-full sm:w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="...">
                            </div>
                        {% endif %}
                        {% endfor %}
                        <!-- Slider controls -->
                        <button type="button" class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
                            <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                                <svg aria-hidden="true" class="w-6 h-6 text-white dark:text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                                <span class="sr-only">Previous</span>
                            </span>
                        </button>
                        <button type="button" class="absolute top-0 right-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
                            <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                                <svg aria-hidden="true" class="w-6 h-6 text-white dark:text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    <span class="sr-only">Next</span>
                            </span>
                        </button>
                        
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
    <div class= "col-span-3 sm:col-span-2">
      <div class="rounded-2xl border-solid border-slate-100 min-w-sm gallery-item-detalle min-h-full">
        <div class="grid gap-y- ">
            <div class="">
                <div class="py-3 px-6 ">
                    Precio de Compra Inmediata
                </div>
                <div class="px-6">
                {% for propiedad in propiedades %}
                    {%if propiedad.id == id%}    
                        <h3 class="text-gray-900 text-center text-6xl font-medium mb-2 min-w-full">{{propiedad.precio|numberFormatInt}} {{propiedad.moneda}}</h3>
                    {% endif %}
                {% endfor %}
                </div>
            </div>
            <!--Tabla Ofertas-->
            {%if ofertas%}
            <div class="grid gap-y-5">
              <div class="">
                <div class="py-3 px-6 ">
                    Últimas Ofertas
                </div>
                <div class="flex flex-col px-6">
                  <div class="overflow-x-auto sm:-mx-6 lg:-mx-8">
                    <div class="py-2 inline-block min-w-full sm:px-6 lg:px-8">
                      <div class="overflow-hidden">
                        <table class="min-w-full">
                          <tbody>
                            {% for oferta in ofertas %}
                            <tr class="bg-gray-100 border-b">
                              <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                                {{oferta.fecha|date:"d-m-y"}}
                              </td>
                              <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                                {{oferta.monto|numberFormatInt}} UF
                              </td>
                              <td class="text-sm text-gray-900 font-light px-6 py-2 whitespace-nowrap">
                                {{oferta.estado}}
                              </td>
                            </tr>
                            {%endfor%}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="pt-0 pb-1 px-6 ">
                  <p id="open-modal-ofertas" class="text-sm">Ver todas las ofertas >>></p>
              </div>
            </div>
            {%else%}
            <div>
              <div class="px-6 pt-6">
                <p class="italic text-center text-gray-400"> No hay ofertas por esta propiedad</p>
              </div>

              <div class="px-6 pt-10">
                <p class="text-center"> Se el primero en ofertar por esta propiedad.</p>
              </div>
            </div>
            {%endif%}
            <div class="my-2 px-6 ">
              <div>
                <!--<button type="button"  id="open-modal-ofertar" class="mb-2 boton-busqueda-portada rounded-lg w-full h-10 text-white font-medium text-lg">ofertar 1</button>-->
                <a href="../../../../propiedades/ofertar/{{id}}/{{slug}}"><button type="button"  id="" class="boton-busqueda-portada rounded-lg w-full h-10 text-white font-medium text-lg">Ofertar</button></a>
              </div>
            </div>
          </div>
        </div>
      </div> 
    </div>
  </div>
</div>

{% include 'componentes/formulario_vender.html' %}


<!--Modal Error Formulario Oferta-->
{%if form_contacto_oferta.errors %}
<div id='modal-error' class='block bg-red-500 max-w-4xl mx-auto rounded-xl px-5 py-4 bg-red-800/60 mt-7'>
  <div class="flex items-center justify-between">
    <h3 class="text-white text-xl sm:text-3xl">&#128400;&#128400; Error al ingresar los datos de tu Oferta</h3>
    <button id="cerrar-modal-error" class="flex text-white">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#000000" viewBox="0 0 256 256">
        <rect width="50" height="50" fill="none"></rect>
        <line x1="200" y1="56" x2="56" y2="200" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></line>
        <line x1="200" y1="200" x2="56" y2="56" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></line>
      </svg>
    </button>
  </div>
  <div class="text-white">{{ form_contacto_ofert.errors }}</div>
</div>
{%endif%}

<!--Modal Oferta Enviada-->
{%if oferta_enviada == '1' %}
<div id='modal-error' class='block bg-green-500 max-w-4xl mx-auto rounded-xl px-5 py-4 bg-red-800/60 mt-7'>
  <div class="flex items-center justify-between">
    <h3 class="text-white text-xl sm:text-3xl">&#128077; &#128077; Muchas Gracias por enviar tu oferta, la revisaremos a la brevedad.</h3>
    <button id="cerrar-modal-error" class="flex text-white">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#000000" viewBox="0 0 256 256">
        <rect width="50" height="50" fill="none"></rect>
        <line x1="200" y1="56" x2="56" y2="200" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></line>
        <line x1="200" y1="200" x2="56" y2="56" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></line>
      </svg>
    </button>
  </div>
</div>
{%endif%}

<!-- Banner de Tarjeta  -->
<div class="max-w-6xl mx-auto rounded-xl mt-5 grid grid-cols-12">

  <div class='col-span-12 sm:col-span-6'>
    <div class='h-20' style="background-image: linear-gradient(to right, rgb(255, 255, 255, 0) 5%, rgba(255, 86, 39, 0.4) 30%,rgba(255, 86, 39, .80) 80%, rgba(255, 86, 39, 1) 100%),  url('{% static "imagenes/banner_tarjeta.jpg" %}');">
      <div class="my-auto"><p class="sm:hidden pt-5 mr-4 text-white text-xl text-right font-semibold"> Paga el Pie con Tarjeta de Crédito</p></div>
    </div>
  </div>
  <div class="hidden sm:block sm:col-span-6 h-full" style="background: rgba(255, 86, 39);">
    <div class=""><p class="my-auto pr-20 text-white text-3xl sm:text-3xl lg:text-3xl text-right font-semibold"> Paga el Pie con Tarjeta de Crédito</p></div>
  </div>
</div>

<!--Banner Carácteristicas importantes-->
{% for propiedad in propiedades %}
  {% if propiedad.id == id %}
    <div class="pt-4 pb-2 px-4 sm:px-2 mx-auto max-w-4xl">
      {% if propiedad.propiedad_bancaria == True %}
        <div class="">
          <div class="flex py-1 detalle-rentabilidad  rounded-md border-solid border-slate-100 min-w-sm gallery-item-detalle">
            <svg class="mx-4" height="18" width="18">
              <circle cx="9" cy="9" r="5" stroke="green" stroke-width="0" fill="green" />
            </svg>  
            <p class="text-sm">Propiedad Bancaria</p>
          </div>
        </div>
      {% endif %}
      {% if rentabilidad_real > 0 %}
        <div class="">
          <div class="flex py-1 detalle-rentabilidad  rounded-md border-solid border-slate-100 min-w-sm gallery-item-detalle">
            <svg class="mx-4" height="18" width="18">
              <circle cx="9" cy="9" r="5" stroke="green" stroke-width="0" fill="green" />
            </svg>  
            <p class="text-sm">Contrato de Arriendo Vigente</p>
          </div>
        </div>
      {% endif %}
      {% if rentabilidad_real > 0 %}
        <div class="">
          <div class="flex py-1 detalle-rentabilidad  rounded-md border-solid border-slate-100 min-w-sm gallery-item-detalle">
            <svg class="mx-4" height="18" width="18">
              <circle cx="9" cy="9" r="5" stroke="green" stroke-width="0" fill="green" />
            </svg>  
            <p class="text-sm">UF + {{rentabilidad_real}} % Rent. Anual</p>
          </div>
        </div>
      {% endif %}
    </div>
  {%endif%}
{%endfor%}

<!--Descripción-->
<div class="py-0 px-4 sm:px-2 mx-auto max-w-4xl">
  <div class="grid sm:grid-cols-5 grid-cols-3 gap-4">
    <div class= "col-span-3">
      {% for propiedad in propiedades %}
        {% if propiedad.id == id %}
          <div class="grid grid-cols-7">
            <div class="col-span-4">
              <div class="grid">
                  <div class="row">
                    <h2 class="text-gray-900 text-xl sm:text-3xl font-medium mb-2">{{propiedad.direccion.upper}}</h2>
                  </div>
                  <div class="row">
                    <h2 class="text-gray-900 sm:text-xl font-medium mb-2">{{propiedad.comuna.comuna.upper}}</h2>
                  </div>
              </div>
            </div>
            <div class="col text-center">
              <div class="grid">
                  <div class="row">
                    {{propiedad.dormitorios}}
                  </div>
                  <div class="row text-xs">
                    dorm.
                  </div>
              </div>
            </div>
            <div class="col text-center">
              <div class="grid">
                  <div class="row">
                    {{propiedad.baños}}
                  </div>
                  <div class="row text-xs">
                    baños
                  </div>
              </div>
            </div>
            <div class="col text-center">
              <div class="grid">
                  <div class="row">
                    {{ propiedad.superficie_construida|numberFormatFloat}}
                  </div>
                  <div class="row text-xs">
                    m<sup>2</sup>
                  </div>
              </div>
            </div>
          </div>
          <div class="grid pt-4">
            <div>
              <h3 class="text-gray-900 text-2xl sm:text-5xl font-medium mb-2">Descripción</h3>
            </div>
            <div>
              <p class="text-justify">{{propiedad.descripcion}}</p>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
    <div class="col-span-3 sm:col-span-2">
      {% for propiedad in propiedades %}
        {%if propiedad.id == id%}
          <div class="grid grid-cols-1 ">
            <div class= "col">
              {%if propiedad.aceptan_contado == True %}
                <div class= "row flex detalle-propiedad py-2 rounded-2xl border-solid border-slate-400 my-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="green" class="w-6 h-6 mx-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  <p>Aceptan Pago Contado</p> 
                </div>
              {%endif%}
              {%if propiedad.aceptan_credito == True %}
                <div class= "row flex detalle-propiedad py-2 rounded-2xl border-solid border-slate-400 my-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="green" class="w-6 h-6 mx-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0012 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75z" />
                  </svg>                               
                  <p>Aceptan Crédito Hipotecario</p>
                </div>
              {%endif%}
              {%if propiedad.aceptan_subsidio == True %}
                <div class= "row flex detalle-propiedad py-2 rounded-2xl border-solid border-slate-400 my-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="green" class="w-6 h-6 mx-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0118 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3l1.5 1.5 3-3.75" />
                  </svg> 
                  <p>Aceptan Subsidio</p>
                </div>
              {%endif%}
              {%if propiedad.aceptan_permuta == True %}
                <div class= "row flex detalle-propiedad py-2 rounded-2xl border-solid border-slate-400 my-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="green" class="w-6 h-6 mx-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3" />
                  </svg>
                  <p>Aceptan Permuta</p>
                </div>
              {%endif%}
            </div>
          </div>            
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<!--Carácterísticas Básicas-->
<div class=" detalle-propiedad my-4 py-4">
  <div class="py-0 px-4 sm:px-2 mx-auto max-w-4xl">
    <div class="grid sm:grid-cols-5 grid-cols-3 gap-4">
      <div class= "col-span-3">
        {% for propiedad in propiedades %}
          {% if propiedad.id == id %}
          <h3 class="text-gray-900 text-2xl sm:text-5xl font-medium mb-2">Características Básicas</h3>
            <div class="grid grid-cols-3 my-2">
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-md font-bold">Dormitorios</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.dormitorios}} dorm</h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-md font-bold">Baños</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.baños}} Baños</h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-md font-bold">Superficie</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.superficie_construida|numberFormatFloat}} m<sup>2</sup></h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 oculto-reverso truncate ms:text-clip text-md font-bold">Superfcie Terraza</h3>
                    <h3 class="text-gray-900 oculto truncate ms:text-clip text-md font-bold">Sup. Terraza</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.superficie_terraza|numberFormatFloat}} m<sup>2</sup></h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 oculto-reverso truncate sm:text-md font-bold">Estacionamientos</h3>
                    <h3 class="text-gray-900 oculto truncate sm:text-md font-bold">Estac.</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.estacionamientos}} est.</h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 text-md font-bold">Bodegas</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.bodegas}} bodegas</h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 oculto-reverso text-md font-bold">Gastos Comunes</h3>
                    <h3 class="text-gray-900 oculto text-md font-bold">GGCC</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">$ {{propiedad.gastos_comunes|numberFormatInt}}</h3>
                  </div>
                </div>
              </div>
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 text-md font-bold">Contribuciones</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">$ {{propiedad.contribuciones|numberFormatInt}} / trim.</h3>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      <!--Map Google Key=AIzaSyA06Q1XXAWcE-H1Lk6QXlXx_ik-vFOqwtE-->
      <script type="text/javascript">
        var propiedad = "{{direccion}}";
        console.log('{{direccion}}');

        function initMap() 
        {
          geocoder = new google.maps.Geocoder();
          var latlng = new google.maps.LatLng(-36.8271921, -73.0502299);
          var mapOptions = 
          {
            zoom: 13,
            center: latlng
          }
          map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
          codeAddress(propiedad);//call the function
        }

        function codeAddress(address) 
        {
          geocoder.geocode( {address:address}, function(results, status) 
          {
            if (status == google.maps.GeocoderStatus.OK) 
            {
              map.setCenter(results[0].geometry.location);//center the map over the result
              //place a marker at the location
              var marker = new google.maps.Marker(
              {
                  map: map,
                  position: results[0].geometry.location
              });
            } else {
              alert('Geocode was not successful for the following reason: ' + status);
          }
          });
        }
      </script>
      <div class="col-span-2">
        <div id="map-canvas" class="h-full w-full"></div>
      </div>
    </div>
  </div>
</div>


<!--Información Financiera-->
<div class="my-4 py-4">
  <div class="py-0 px-4 sm:px-2 mx-auto max-w-4xl">
    {% for propiedad in propiedades %}
    {% if propiedad.id == id %}
    <h3 class="text-gray-900 text-3xl font-medium mb-4">Información Financiera</h3>
    <div class="grid sm:grid-cols-10 grid-cols-3 gap-4 gap-y-0">
      <div class= "col-span-5">
        <div class="grid grid-cols-2 mb-0 sm:my-2">
          <div class="col my-2">
            <div class="grid grid-cols-1">
              <div class="row">
                <h3 class="text-gray-900 text-md font-bold">Precio de Lista </h3>
              </div>
              <div class="row">
                <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.precio|numberFormatInt}} {{propiedad.moneda}}</h3>
              </div>
            </div>
          </div>
          <div class="col my-2">
            <div class="grid grid-cols-1">
              <!--Aceptan Ofertas-->
              <!--<div class="row">
                <h3 class="text-gray-900 text-md font-bold">Aceptan Ofertas</h3>
              </div>
              <div class="row">
                <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{% if propiedad.aceptan_oferta == True %} Si{%endif%}{% if propiedad.aceptan_oferta == False %} No{%endif%}<</h3>
              </div>
            </div>
          </div>
          <div class="col my-2">
            <div class="grid grid-cols-1">-->
              <div class="row">
                <h3 class="text-gray-900 text-md font-bold">Tasación Comercial</h3>
              </div>
              <div class="row">
                <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.tasacion_comercial|numberFormatInt}} UF</h3>
              </div>
            </div>
          </div>
          <div class="col my-2">
            <div class="grid grid-cols-1">
              <div class="row">
                <h3 class="text-gray-900 text-md font-bold">Tasación Fiscal</h3>
              </div>
              <div class="row">
                <h3 class="text-gray-900 sm:text-xl font-normal mb-2">$ {{propiedad.tasacion_fiscal|numberFormatInt}}</h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    {% endfor %}
  </div>
</div>

<!--Información Legal-->
<div class="my-4 py-4">
    <!-- Modal Propiedad Bancaria -->
    <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_prop_banc" >
      <div class="border-2">
          <div class="m-4 p-2">
            <div class="my-4">Propiedad Bancaria: significa que este bien inmueble es propiedad de un banco, lo que implica que actualmente se mantiene sin Hipoteca, gravámenes ni litigios de ningún tipo.
            </div>
          </div>
          <button type="button" class="absolute right-1 top-1 " id="close_modal_prop_banc">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
      </div>
    </div>
    <!--FIN MODAL-->



  <div class="py-0 px-4 sm:px-2 mx-auto max-w-4xl">
    <div class="grid sm:grid-cols-5 grid-cols-3 gap-4">
      <div class= "col-span-3">
        {% for propiedad in propiedades %}
          {% if propiedad.id == id %}
            <h3 class="text-gray-900 text-3xl font-medium mb-4">Información Legal</h3>
            <div class="grid grid-cols-1 my-2">
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 text-md font-bold">Ocupación</h3>
                  </div>
                  <div class="row">
                    <h3 class="text-gray-900 sm:text-xl font-normal mb-2">{{propiedad.estado_ocupacion}}</h3>
                  </div>
                </div>
              </div>
              {% if propiedad.propiedad_bancaria == True %}
              <div class="col my-2">
                <div class="grid grid-cols-1">
                  <div class="row">
                    <h3 class="text-gray-900 text-md font-bold">Propiedad Bancaria  
                      <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_prop_banc">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                        </svg>
                      </button> 
                    </h3>
                  </div>
                  <div class="row">
                    <p class="text-gray-900 sm:text-xl font-normal mb-2"> Sí </p>
                  </div>
                </div>
              </div> 
              {% endif %}
              <div class="col col-span-2 my-2">
                <h3 class="text-gray-900 text-md font-bold">Documentos Legales Descargables</h3>
                {% for documento in documentos  %}
                {% if documento.id_propiedades.id == propiedad.id %}
                    <div>
                        <a href="{{ documento.documento.url }}" target="_blank"> 
                            <div class="flex">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                </svg>
                                <div class="pl-2">{{ documento.titulo }}
                                </div>
                            </div>
                        </a>
                    </div>
                {% endif %}
                {% endfor %}
                </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>


    <!-- Modal CAE -->
    <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_cae" >
      <div class="border-2">
          <div class="m-4 p-2">
            El CAE son las siglas para Carga Anual Equivalente, un indicador porcentual que incluye los intereses, gastos y seguros asociados al crédito en un periodo de un año. 
          </div>
          <button type="button" class="absolute right-1 top-1 " id="close_modal_cae">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
      </div>
    </div>
    <!--FIN MODAL-->

<!--Análisis Financiero-->
<div class="my-4 py-4">


  <div class="py-0 px-4 sm:px-2 mx-auto max-w-4xl">
    <h3 class="text-gray-900 text-3xl font-medium mb-4">Análisis Financiero</h3>
    <div class="grid grid-cols-1 gap-y-1">
      <div class="row">
        <div class="row grid grid-cols-6 sm:grid-cols-12 sm:gap-x-2 mt-3">
          <!--Detalle de Costos Operacionales-->
          <div class= "col-span-12">
            <h3 class="text-gray-900 text-md font-bold">Información Básica</h3>
          </div>
          <div class= "col-span-6">
            <form name="form-financiar" method="post" action="{{ request.get_full_path }} ">
              {% csrf_token %}
              <div class="grid grid-cols-12">
                <!--Precio de Compra-->
                <div class="col-span-5">
                  <p class="inline-block align-middle ml-2 mt-3">Precio de Compra</p>
                </div>
                <div class="block class col-span-5 form-group" >
                  <div id="molesta_cae">
                    {{formulario_financiero.precio_compra}} 
                  </div>
                </div>
                <div class="col-span-2">
                  <p class="inline-block align-middle ml-2 mt-3">UF</p>
                </div>
                <!--% de Pie-->
                <div class="col-span-5">
                  <p class="inline-block align-middle ml-2 mt-3">Pie</p>
                </div>
                <div class="class col-span-5 form-group">
                  {{formulario_financiero.pie}} 
                </div>
                <div class="col-span-2">
                  <p class="inline-block align-middle ml-2 mt-3">%</p>
                </div>
                <!--Tasa Crédito-->
                <div class="col-span-5">
                  <p class="inline-block align-middle ml-2 mt-3">Tasa CAE
                  <button type="button" class="inline-block font-medium text-xs leading-tight" id="open_modal_cae">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                    </svg>
                  </button></p>
                </div>
                <div class="class col-span-5 form-group">
                  {{formulario_financiero.tasa}} 
                </div>
                <div class="col-span-2">
                  <p class="inline-block align-middle ml-2 mt-3">%</p>
                </div>
                <!--Arriendo Esperado-->
                {% for propiedad in propiedades %}
                {% if propiedad.id == id %}
                {% if propiedad.arriendo_actual == 0%}
                <div class="col-span-5">
                  <p class="inline-block align-middle ml-2 mt-3">Arriendo Esperado</p>
                </div>
                <div class="class col-span-5 form-group">
                  {{formulario_financiero.arriendo_esperado}} 
                </div>
                <div class="col-span-2">
                  <p class="inline-block align-middle ml-2 mt-3">UF</p>
                </div>
                {%endif%}
                {%endif%}
                {%endfor%}
                <!--Botón de Recalcular-->
                <div class="col-span-2"></div>
                <div class="col-span-2"></div>
                <!--<div class="col-span-8">
                  <select class="w-35" name="moneda_resultados">
                  <option>Pesos</option>
                  <option>UF</option>
                  </select>
                </div>-->
                <div class="my-2 col-span-12">
                  <button href="javascript:void(0);" onclick="document.form-ofertar.submit();" class="w-1/2 mr-1 px-6 py-1.5 boton-busqueda-portada rounded-lg w-full h-full text-white font-medium text-lg" name="enviar" value="recalcular">Recalcular</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!--Comisión Corretaje-->
      <div class="row mt-6">
        <h3 class="text-gray-900 text-md font-bold">Comisión de Corretaje</h3>
      </div>
      <div class="row">
        <p class="text-gray-900 text-xl font-normal mb-2">El comprador de esta propiedad NO paga comisión de Corretaje.</p>
      </div>
    </div>
  </div>
</div>
    
<!--Detalle de Costos Operacionales-->
<div class="my-4 py-4 px-4 sm:px-2 mx-auto max-w-4xl">
  <div class= "col-span-6 hidden">
    <h3 class="text-gray-900 text-md font-bold">Detalle de los Costos Operacionales</h3>
  </div>

  <!--Calculo de Plusvalia-->
  <div class= "mt-8 sm:mt-0 col-span-6">
    <!-- Modal Costo Operacional -->
    <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_costo_operacional" >
      <div class="border-2">
          <div class="m-4 p-2">
            <div class="grid grid-cols-1 gap-0 mt-2">
              <div class="grid grid-cols-12 bg-gray-100">
                <div class="col-span-6"> <p class="text-xs ml-4 my-2">Estudio de Títulos</p></div>
                <div class="col-span-3"> <p class="text-xs ml-4 my-2"></p></div>
                <div class="col-span-3 mr-2"> <p class="text-xs my-2 text-right ml-2">{{costo_estudio}} UF</p></div>
              </div>
              <div class="grid grid-cols-12 bg-white">
                <div class="col-span-6"> <p class="text-xs ml-4 my-2">Confección de la Escritura</p></div>
                <div class="col-span-3"> <p class="text-xs ml-4 my-2"></p></div>
                <div class="col-span-3 mr-2"> <p class="text-xs my-2 text-right ml-2">{{costo_escritura}} UF</p></div>
              </div>
              <div class="grid grid-cols-12 bg-gray-100">
                <div class="col-span-6"> <p class="text-xs ml-4 my-2">Notaría: Firma Compraventa*</p></div>
                <div class="col-span-3"> <p class="text-xs ml-4 my-2"></p></div>
                <div class="col-span-3 mr-2"> <p class="text-xs my-2 text-right ml-2">{{costo_notaria}} UF</p></div>
              </div>
              <div class="grid grid-cols-12 bg-white">
                <div class="col-span-6"> <p class="text-xs ml-4 my-2">Obtención de Vales Vistas**</p></div>
                <div class="col-span-3"> <p class="text-xs ml-4 my-2"></p></div>
                <div class="col-span-3 mr-2"> <p class="text-xs my-2 text-right ml-2">{{costo_vv}} UF</p></div>
              </div>
              <div class="grid grid-cols-12 bg-gray-100">
                <div class="col-span-6"> <p class="text-xs ml-4 my-2">Inscrip. en Conservador de Bienes Raíces</p></div>
                <div class="col-span-3"> <p class="text-xs ml-4 my-2"></p></div>
                <div class="col-span-3 mr-2"> <p class="text-xs my-2 text-right ml-2">{{costo_cbr}} UF</p></div>
              </div>
              <div class="grid grid-cols-12 bg-white">
                <div class="col-span-6"> <p class="font-semibold text-xs ml-4 my-2">Total Costos Operacionales</p></div>
                <div class="col-span-3"> </div>
                <div class="col-span-3 mr-2"> <p class="font-semibold text-xs my-2 text-right ml-2">{{total_costo}} UF</p></div>
              </div>
            </div>
            <p class="text-justify text-xs">* El costo notaría de la firma del contrato de compraventa lo asume el comprador.</p>
            <p class="text-justify text-xs">** La emisión de Vale Vista tiene un costo de 0,3 UF apróx. Además es importante considerar que cada Vale Vista puede ser de máximo $49 millones de pesos.
          </div>
          <button type="button" class="absolute right-1 top-1 " id="close_modal_costo_operacional">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
      </div>
    </div>
    <!--FIN MODAL-->

    <!-- Modal Plusvalia Inmediata -->
    <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_plusvalia" >
      <div class="border-2">
          <div class="m-4 p-2">
            <div class="my-4">La Plusvalía Inmediata se calcula como: </div>
            <img src="{% static "imagenes/plusvalia_In_1.PNG" %}" class="" alt="Plusvalia Inmediata"></a>
          </div>
          <button type="button" class="absolute right-1 top-1 " id="close_modal_plusvalia">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
      </div>
    </div>
    <!--FIN MODAL-->

    <!-- Modal Plusvalia Inmediata -->
    <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_plusvalia_porc" >
      <div class="border-2">
          <div class="m-4 p-2">
            <div class="my-4">La Plusvalía Inmediata se calcula como: </div>
            <div class="grid grid-cols-5 grid-row-3 sm:grid-cols-7">
              <div class="col-span-3 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">Plusvalía Inmediata Porcentual</div>
              <div class="col-span-2 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">=</div>
              <div class="col-span-1 text-xs sm:text-sm">Tasación Comercial</div>
              <div class="col-span-1 text-xs sm:text-sm">-</div>
              <div class="col-span-1 text-xs sm:text-sm">Precio Compra</div>
              <div class="col-span-1 text-xs sm:text-sm">-</div>
              <div class="col-span-1 text-xs sm:text-sm">Costos Operacionales</div>
              <div class="col-span-5 text-xs sm:text-sm my-2"><hr class="border-2 border-gray-500"></div>
              <div class="col-span-5 text-center text-xs sm:text-sm my-2">Tasción Comercial</div>
            </div>
          </div>
          <button type="button" class="absolute right-1 top-1 " id="close_modal_plusvalia_porc">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
      </div>
    </div>
    <!--FIN MODAL-->

    <div class="row">
      <h3 class="text-gray-900 text-md font-bold">Cálculo de la Plusvalía Inmediata</h3>
    </div>
    <div class="grid grid-cols-1 gap-0 mt-2">
      <div class="grid grid-cols-12 bg-gray-100">
        <div class="col-span-6"> <p class="text-sm ml-4 my-2">Precio de Compra</p></div>
        <div class="col-span-3"> <p class="text-sm ml-4 my-2"></p></div>
        <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">{{costo_compra|numberFormatInt}} UF</p></div>
      </div>
      <div class="grid grid-cols-12 bg-white">
        <div class="col-span-6"> <p class="flex text-sm ml-4 my-2">Costos Operacionales </p></div>
        <div class="col-span-3"> 
          <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_costo_operacional">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
          </button>
        </div>
        <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">{{total_costo}} UF</p></div>
      </div>
      <div class="grid grid-cols-12 bg-gray-100">
        <div class="col-span-6"> <p class="text-sm ml-4 my-2">Tasación Comercial</p></div>
        <div class="col-span-3"> </div>
        <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">{{tasacion_com|numberFormatInt}} UF</p></div>
      </div>
      <div class="grid grid-cols-12 bg-white">
        <div class="col-span-6"> <p class="font-semibold text-sm ml-4 my-2">Plusvalía Inmediata</p></div>
        <div class="col-span-3"> 
          <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_plusvalia">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
          </button>
        </div>
        <div class="col-span-3 mr-2"> <p class="font-semibold text-sm my-2 text-right">{{plusvalia}} UF</p></div>
      </div>
      <div class="grid grid-cols-12 bg-gray-100">
        <div class="col-span-6"> <p class="font-semibold text-sm ml-4 my-2">Plusvalía Inmediata Porcentual</p></div>
        <div class="col-span-3"> 
          <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_plusvalia_porc">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
          </button>
        </div>
        <div class="col-span-3 mr-2"> <p class="font-semibold text-sm my-2 text-right ml-2">{{plusvalia_porc}} %</p></div>
      </div>
    </div>
  </div>
  

  <!-- Modal Administracion Arriendo-->
  <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_administracion" >
    <div class="border-2">
        <div class="m-4 p-2">
          <div class="my-4">El costo mensual de administración de arriendo se calcula como: </div>
          <div class="grid grid-cols-5 grid-row-3 sm:grid-cols-7">
            <div class="col-span-3 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">Costo Mensual de Administración de Arriendo</div>
            <div class="col-span-2 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">=</div>
            <div class="col-span-1 text-xs sm:text-sm">Arriendo Mensual</div>
            <div class="col-span-1 text-xs sm:text-sm">*</div>
            <div class="col-span-1 text-xs sm:text-sm">7%</div>
            <div class="col-span-1 text-xs sm:text-sm">*</div>
            <div class="col-span-1 text-xs sm:text-sm">IVA (1,19)</div>
          </div>
        </div>
        <button type="button" class="absolute right-1 top-1 " id="close_modal_administracion">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
    </div>
  </div>
  <!--FIN MODAL-->


  <!-- Modal Plusvalia Inmediata -->
  <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_rentabilidad_c_adm" >
    <div class="border-2">
        <div class="m-4 p-2">
          <div class="my-4">La rentabilidad anual con administración de arriendo se calcula como: </div>
          <div class="grid grid-cols-5 grid-row-3 sm:grid-cols-7">
            <div class="col-span-3 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">Rentabilidad Anual con Administración de Arriendo</div>
            <div class="col-span-2 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">=</div>
            <div class="col-span-1 text-xs sm:text-sm">Ingreso Anual por Arriendo </div>
            <div class="col-span-1 text-xs sm:text-sm">-</div>
            <div class="col-span-1 text-xs sm:text-sm">Costo Anual por Administración</div>
            <div class="col-span-1 text-xs sm:text-sm">-</div>
            <div class="col-span-1 text-xs sm:text-sm">Costo Anual Contribuciones</div>
            <div class="col-span-5 text-xs sm:text-sm my-2"><hr class="border-2 border-gray-500"></div>
            <div class="col-span-5 text-center text-xs sm:text-sm my-2">Precio de Compra</div>
          </div>
        </div>
        <button type="button" class="absolute right-1 top-1 " id="close_modal_rentabilidad_c_adm">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
    </div>
  </div>
  <!--FIN MODAL-->

  <!-- Modal Plusvalia Inmediata -->
  <div class="hidden absolute bg-white sm:left-1/2 transform sm:-translate-x-1/2" id="modal_component_container_rentabilidad_s_adm" >
    <div class="border-2">
        <div class="m-4 p-2">
          <div class="my-4">La rentabilidad anual sin administración de arriendo se calcula como: </div>
          <div class="grid grid-cols-3 grid-row-3 sm:grid-cols-5">
            <div class="col-span-2 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">Rentabilidad Anual sin Administración de Arriendo</div>
            <div class="col-span-1 row-span-3 sm:col-span-1 text-xs sm:text-sm inline-block align-middle my-2 sm:my-0">=</div>
            <div class="col-span-1 text-xs sm:text-sm">Ingreso Anual por Arriendo </div>
            <div class="col-span-1 text-xs sm:text-sm">-</div>
            <div class="col-span-1 text-xs sm:text-sm">Costo Anual Contribuciones</div>
            <div class="col-span-3 text-xs sm:text-sm my-2"><hr class="border-2 border-gray-500"></div>
            <div class="col-span-3 text-center text-xs sm:text-sm my-2">Precio de Compra</div>
          </div>
        </div>
        <button type="button" class="absolute right-1 top-1 " id="close_modal_rentabilidad_s_adm">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
    </div>
  </div>
  <!--FIN MODAL-->

  
  <!--Calculo de Rentabildiad-->
  <!--Título-->
  <div class="row mt-8">
    <h3 class="text-gray-900 text-md font-bold">Cálculo de Rentabilidad Anual {% for propiedad in propiedades %} {% if propiedad.id == id %} {% if propiedad.arriendo_actual > 0%}Real{%else%}Esperado{%endif%} {%endif%} {%endfor%}</h3>
  </div>
  <!--Tabla-->
  <div class="row mt-2">
    <div class="grid grid-cols-12 bg-gray-100">
      <div class="col-span-6"> <p class="text-sm ml-4 my-2">Ingresos Mensual por Arriendo</p></div>
      <div class="col-span-3"> <p class="text-sm ml-4 my-2"></p></div>
      <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">{{arriendo}} UF</p></div>
    </div>
    <div class="grid grid-cols-12 bg-white">
      <div class="col-span-6"> <p class="text-sm ml-4 my-2">Costo Mensual Administración de Arriendo </p></div>
      <div class="col-span-3"> 
        <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_administracion">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
          </svg>
        </button>  
      </div>
      <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">{{comision_arriendo}} UF</p></div>
    </div>
    <div class="grid grid-cols-12 bg-gray-100">
      <div class="col-span-6"> <p class="text-sm ml-4 my-2">Costo Mensual Contribuciones</p></div>
      <div class="col-span-3"> <p class="text-sm ml-4 my-2"></p></div>
      <div class="col-span-3 mr-2"> <p class="text-sm my-2 text-right ml-2">0 UF</p></div>
    </div>
    <div class="grid grid-cols-12 bg-white">
      <div class="col-span-6"> <p class="font-semibold text-sm ml-4 my-2">Rentabilidad Anual c/ Administración </p></div>
      <div class="col-span-3"> 
        <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_rentabilidad_c_adm">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
          </svg>
        </button> 
      </div>
      <div class="col-span-3 mr-2"> <p class="font-semibold text-sm my-2 text-right ml-2">{{rentabilidad_anual_c_adm}} %</p></div>
    </div>
    <div class="grid grid-cols-12 bg-gray-100">
      <div class="col-span-6"> <p class="font-semibold text-sm ml-4 my-2">Rentabilidad Anual s/ Administración</p></div>
      <div class="col-span-3"> 
        <button type="button" class="inline-block px-6 font-medium text-xs leading-tight" id="open_modal_rentabilidad_s_adm">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
          </svg>
        </button> 
      </div>
      <div class="col-span-3 mr-2"> <p class="font-semibold text-sm my-2 text-right ml-2">{{rentabilidad_anual_s_adm}} %</p></div>
    </div>
  </div>

  <!--Sensibilización-->
  <!--SEnsibilización-->
  <div class="row mt-8">
    <h3 class="text-gray-900 text-md font-bold">Sensibilización de Cuota de Crédito</h3>
  </div>
  <!--Tabla-->
  <div class="row mt-2">
    <p class="text-gray-900 text-md">La siguiente tabla muesta cómo cambia la cuota del crédito hipoteracio en la medida que cambia el porcentaje de pie y el plazo en años al que se toma el crédito.</p>
  </div>
  <div class="row mt-2">
    <div class="grid grid-rows-5 grid-cols-7">
      <!--Primera Fila-->
      <div class="text-center bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm"></p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">5 años</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">10 años</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">15 años</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">20 años</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">25 años</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">30 años</p>
      </div>
      <!--2da Fila-->
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">20 %</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'1,1'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'2,1'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'3,1'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'4,1'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'5,1'}} UF</p>
      </div>
      <div>
        <p  class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'6,1'}} UF</p>
      </div>
      <!--3da Fila-->
      <div class="bg-gray-100">
        <p  class="text-center my-2 text-xs sm:text-sm">30 %</p>
      </div>
      <div class="bg-gray-100">
        <p  class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'1,2'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p  class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'2,2'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p  class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'3,2'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p  class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'4,2'}} UF</p>
      </div>
      <div  class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'5,2'}} UF</p>
      </div>
      <div  class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'6,2'}} UF</p>
      </div>
      <!--4da Fila-->
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">40 %</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'1,3'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'2,3'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'3,3'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'4,3'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'5,3'}} UF</p>
      </div>
      <div>
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'6,3'}} UF</p>
      </div>
      <!--5da Fila-->
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">50 %</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'1,4'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'2,4'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'3,4'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'4,4'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'5,4'}} UF</p>
      </div>
      <div class="bg-gray-100">
        <p class="text-center my-2 text-xs sm:text-sm">{{cuotas.0|accede_diccionario:'6,4'}} UF</p>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
{% block extra_footer %} {% endblock extra_footer %}
{% block scripts %} 
<script src="https://unpkg.com/flowbite@1.4.0/dist/flowbite.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA06Q1XXAWcE-H1Lk6QXlXx_ik-vFOqwtE&callback=initMap" defer></script>

<script>
  const openButton_costo_operacional = document.querySelector('#open_modal_costo_operacional');
  const modalContainer_costo_operacional = document.querySelector('#modal_component_container_costo_operacional');
  const closeButton_costo_operacional = document.querySelector('#close_modal_costo_operacional');
  
  const openButton_plusvalia = document.querySelector('#open_modal_plusvalia');
  const modalContainer_plusvalia = document.querySelector('#modal_component_container_plusvalia');
  const closeButton_plusvalia = document.querySelector('#close_modal_plusvalia');

  const openButton_plusvalia_porc = document.querySelector('#open_modal_plusvalia_porc');
  const modalContainer_plusvalia_porc = document.querySelector('#modal_component_container_plusvalia_porc');
  const closeButton_plusvalia_porc = document.querySelector('#close_modal_plusvalia_porc');

  const openButton_administracion = document.querySelector('#open_modal_administracion');
  const modalContainer_administracion = document.querySelector('#modal_component_container_administracion');
  const closeButton_administracion = document.querySelector('#close_modal_administracion');
  
  const openButton_rentabilidad_c_adm = document.querySelector('#open_modal_rentabilidad_c_adm');
  const modalContainer_rentabilidad_c_adm = document.querySelector('#modal_component_container_rentabilidad_c_adm');
  const closeButton_rentabilidad_c_adm = document.querySelector('#close_modal_rentabilidad_c_adm');

  const openButton_rentabilidad_s_adm = document.querySelector('#open_modal_rentabilidad_s_adm');
  const modalContainer_rentabilidad_s_adm = document.querySelector('#modal_component_container_rentabilidad_s_adm');
  const closeButton_rentabilidad_s_adm = document.querySelector('#close_modal_rentabilidad_s_adm');

  const openButton_prop_banc= document.querySelector('#open_modal_prop_banc');
  const modalContainer_prop_banc = document.querySelector('#modal_component_container_prop_banc');
  const closeButton_prop_banc = document.querySelector('#close_modal_prop_banc');
  
  const openButton_cae= document.querySelector('#open_modal_cae');
  const modalContainer_cae = document.querySelector('#modal_component_container_cae');
  const closeButton_cae = document.querySelector('#close_modal_cae');
  const molesta_cae = document.querySelector('#molesta_cae');

  openButton_costo_operacional.addEventListener('click', () => {
    openModal(modalContainer_costo_operacional);
  });

  closeButton_costo_operacional.addEventListener('click', () => {
    closeModal(modalContainer_costo_operacional );
  });

  openButton_plusvalia.addEventListener('click', () => {
    openModal(modalContainer_plusvalia);
  });

  closeButton_plusvalia.addEventListener('click', () => {
    closeModal(modalContainer_plusvalia);
  });

  openButton_plusvalia_porc.addEventListener('click', () => {
    openModal(modalContainer_plusvalia_porc);
  });

  closeButton_plusvalia_porc.addEventListener('click', () => {
    closeModal(modalContainer_plusvalia_porc);
  });

  openButton_administracion.addEventListener('click', () => {
    openModal(modalContainer_administracion);
  });

  closeButton_administracion.addEventListener('click', () => {
    closeModal(modalContainer_administracion);
  });
  
  openButton_rentabilidad_c_adm.addEventListener('click', () => {
    openModal(modalContainer_rentabilidad_c_adm);
  });

  closeButton_rentabilidad_c_adm.addEventListener('click', () => {
    closeModal(modalContainer_rentabilidad_c_adm);
  });

  openButton_rentabilidad_s_adm.addEventListener('click', () => {
    openModal(modalContainer_rentabilidad_s_adm);
  });

  closeButton_rentabilidad_s_adm.addEventListener('click', () => {
    closeModal(modalContainer_rentabilidad_s_adm);
  });

  openButton_prop_banc.addEventListener('click', () => {
    openModal(modalContainer_prop_banc);
  });

  closeButton_prop_banc.addEventListener('click', () => {
    closeModal(modalContainer_prop_banc);
  });

  openButton_cae.addEventListener('click', () => {
    openModal(modalContainer_cae);
    closeModal(molesta_cae)
  });

  closeButton_cae.addEventListener('click', () => {
    closeModal(modalContainer_cae);
    openModal(molesta_cae)
  });

  function openModal(modalContainer) {
    showAndHide(modalContainer, ['block'], ['hidden']);
  }

  function closeModal(modalContainer) {
    showAndHide(modalContainer, ['hidden'], ['block']);
  }

  function showAndHide(element, classesToAdd, classesToRemove) {
    element.classList.add(...classesToAdd);
    element.classList.remove(...classesToRemove);
  }


</script>

{% if oferta_enviada == '1'%}
<script>
  const modalError = document.querySelector('#modal-error');
  const closeButtonError = document.querySelector('#cerrar-modal-error');

  closeButtonError.addEventListener('click', () => {
    closeModalError();
  });

  function closeModalError() {
    showAndHide(modalError, ['hidden'], ['block']);
  }
  
  function showAndHide(element, classesToAdd, classesToRemove) {
    element.classList.add(...classesToAdd);
    element.classList.remove(...classesToRemove);
  }
</script>
{%endif%}

{% endblock scripts %}